# Facebook 應用程式設定檢查清單

## 基本設定 ✅
- [x] 應用程式網域：`eccal.thinkwithblack.com`
- [x] 聯絡電子郵件：`backtrue@toldyou.co`
- [x] 隱私政策網址：`https://thinkwithblack.com/privacy`
- [x] 服務條款網址：`https://thinkwithblack.com/terms`
- [x] 類別：工具和生產力
- [x] 用戶資料刪除回調：`https://eccal.thinkwithblack.com/auth/facebook/data-deletion`
- [x] 商家驗證：已驗證（煜言顧問有限公司）

## 需要檢查的項目 ⚠️

### 1. Facebook 登入產品設定 ✅
- **路徑**: 產品 → Facebook 登入 → 設定
- **需要添加的 OAuth 重新導向 URI**:
  ```
  https://eccal.thinkwithblack.com/api/diagnosis/facebook-callback
  ```

### 2. 應用程式模式 ✅
- **路徑**: 應用程式 → 設定 → 基本資料
- **狀態**: 已確認為「上線」模式
- **管理者測試**: 管理者帳號可以正常使用

### 3. 權限申請狀態 🚨 **需要立即處理**
- **路徑**: 應用程式審查 → 權限和功能
- **需要的權限**:
  - `ads_read` - 讀取廣告數據
  - `ads_management` - 管理廣告帳戶
- **當前狀態**: 需要提交 Facebook 審查
- **問題**: 只有應用程式管理者可以使用，一般用戶無法存取

### 4. 測試用戶設定（如果權限還在審核中）
- **路徑**: 角色 → 測試用戶
- **操作**: 添加測試帳號或將特定用戶添加為測試用戶

## 常見問題解決

### 錯誤: "此應用程式似乎無法取得" 🚨
**最常見原因**：
1. **應用程式還在開發模式** - 需要切換到「上線」模式
2. **缺少必要的應用程式資訊** - 需要完整填寫所有必要欄位
3. **權限未通過審核** - 需要完成 Facebook 審核流程
4. **應用程式被限制** - 檢查是否有任何限制或警告

**解決步驟**：
1. 進入 Facebook 開發者控制台
2. 檢查應用程式模式 (開發/上線)
3. 確認所有必要資訊已填寫完整
4. 檢查應用程式審查狀態
5. 如果需要，提交應用程式供 Facebook 審核

### 錯誤: "Cannot use this feature"
- 檢查應用程式是否已上線
- 確認 OAuth 重新導向 URI 是否正確設定
- 檢查權限是否已通過審核

### 錯誤: "重新導向 URI 不匹配"
- 確保添加了正確的重新導向 URI
- 檢查 HTTPS 協議是否正確

### 錯誤: "權限被拒絕"
- 將使用者添加為測試用戶
- 或等待 Facebook 審核通過

## Facebook 應用程式審查流程 🔥 **重要**

### 為什麼需要審查？
- Facebook 的 `ads_read` 和 `ads_management` 權限屬於敏感權限
- 需要通過 Facebook 審查後才能對一般用戶開放
- 目前只有應用程式管理者和開發者可以使用

### 提交審查步驟：
1. **進入應用程式審查頁面**
   - 路徑：應用程式審查 → 權限和功能
   
2. **申請必要權限**
   - 點擊「新增權限」
   - 選擇 `ads_read` 和 `ads_management`
   
3. **提供審查資料**
   - 說明使用目的：「為電商廣告分析工具提供 Facebook 廣告數據讀取功能」
   - 提供應用程式使用說明
   - 上傳應用程式截圖和操作影片
   
4. **準備審查文件**
   - 應用程式功能說明文檔
   - 用戶隱私保護措施
   - 數據使用政策

### 審查時間：
- 一般需要 3-7 個工作天
- 複雜案例可能需要 2-3 週

## 測試步驟
1. 訪問 `/fbaudit` 頁面
2. 點擊「Facebook 登入」按鈕
3. 完成 OAuth 授權流程
4. 檢查是否能正確獲取廣告帳戶數據

**目前狀態**: 只有管理者帳號可以測試，一般用戶需要等待審查通過

## 聯絡資訊
如果遇到問題，請檢查：
- Facebook 開發者控制台的錯誤日誌
- 瀏覽器開發者工具的 Console 錯誤
- 伺服器日誌 (`/api/diagnosis/facebook-callback` 的回調處理)